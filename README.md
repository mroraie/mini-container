# مینی کانتینر (Mini Container)

این پروژه، پروژه نهایی درس سیستم های عامل می باشد که یک پیاده‌سازی ساده از کانتینرها با استفاده از قابلیت‌های هسته لینوکس است. هدف این پروژه بررسی و استفاده از مفاهیم سیستم‌عامل مانند ایزولاسیون فرایند و مدیریت منابع می باشد.

## ویژگی‌های کلیدی
* **ایزولاسیون فرایند**: استفاده از Linux Namespaces (PID, Mount, UTS, Network, User).
* **مدیریت منابع**: کنترل میزان مصرف CPU و RAM با استفاده از Cgroups.
* **امنیت فایل‌سیستم**: استفاده از `chroot` برای محدودسازی دسترسی به دایرکتوری ریشه.
* **مدیریت چرخه حیات**: قابلیت ایجاد، شروع، توقف و حذف کانتینر. (در این پروژه کانتینر ها به صورت State-Base می باشند.)
* **رابط کاربری**: دارای خط فرمان (CLI) و رابط گرافیکی ترمینالی (TUI) و نمایش در وب سرور می باشد.

## پیش‌نیازها برای اجرا
* **هسته لینوکس**: نسخه ۳.۸ یا بالاتر.
* **کامپایلر**: GCC (g++) با پشتیبانی از C++11.
* **دسترسی**: اجرای دستورات با سطح دسترسی `root` یا `sudo`.
* **تقسیم منابع با Cgroups**: باید در مسیر `/sys/fs/cgroup` مونت شده باشد.

## نصب و راه‌اندازی

کامپایل پروژه:
```bash
git clone https://github.com/mroraie/mini-container.git
cd mini-container
make clean
make
./mini-container

```

## نحوه استفاده

### 1) رابط گرافیکی ترمینال

برای تجربه بصری مدیریت کانتینرها:

```bash
./mini-container-ui

```
### 2) دستورات خط فرمان (CLI)
* **اجرای یک دستور در کانتینر:**
`./mini-container run /bin/echo "Hello World"`
* **اجرا با محدودیت منابع:**
`./mini-container run --memory 128 --cpu 512 /bin/sh`
* **مشاهده وضعیت:**
`./mini-container list`
`./mini-container info <container_id>`
* **توقف و حذف:**
`./mini-container stop <container_id>`
`./mini-container destroy <container_id>`

### 3) نمایش در وب سرور




## مفاهیم سیستم‌عامل به کار رفته

### ۱. Linux Namespaces

این تکنولوژی باعث می‌شود فرایند داخل کانتینر فکر کند سیستم کاملاً متعلق به خودش می باشد و کانتینر دیگری در حال اجرا نمی باشد:

* **PID**: فرایندها فقط خودشان را می‌بینند.
* **Mount**: فایل‌سیستم ایزوله.
* **UTS**: نام میزبان (Hostname) جداگانه.
* **Network**: کارت شبکه مجازی مستقل.

### ۲. Control Groups (Cgroups)

برای جلوگیری از مصرف تمام منابع سیستم توسط یک کانتینر:

* **CPU**: تعیین سهمیه پردازش.
* **Memory**: تعیین سقف مصرف رم و Swap.

### ۳. فراخوانی‌های سیستمی (System Calls)

* `clone()`: برای ایجاد فرایند جدید با فضاهای نام مشخص.
* `unshare()`: برای جدا کردن بخش‌های مشترک فرایند.
* `mount()` و `chroot()`: برای ایزولاسیون دایرکتوری‌ها.


## مقایسه مینی کانتینر با داکر (Docker)
برای ساخت این پروژه از داکر الهام گرفته شده است و در طراحی و پیاده سازی سعی شده است که مفاهیم اولیه ای از داکر در این پروژه استفاده شود:

| ویژگی | مینی کانتینر | Docker |
| --- | --- | --- |
| **ایزولاسیون** | فضای نام هسته (Namespace) | فضای نام + لایه‌های امنیتی اضافی |
| **مدیریت منابع** | cgroups ساده | cgroups پیشرفته + سهمیه‌بندی دقیق |
| **فایل‌سیستم** | chroot ساده | سیستم لایه‌ای (OverlayFS) |
| **شبکه** | فضای نام پایه | پل‌های مجازی (Bridge) و شبکه پیچیده |
| **پیچیدگی** | بسیار کم (آموزشی) | بالا (صنعتی) |

## تست‌های عملکرد

برای اطمینان از ایزولاسیون، می‌توانید تست‌های زیر را داخل کانتینر اجرا کنید:

* **تست فشار CPU:**
`while true; do :; done`
* **تست محدودیت حافظه:**
`dd if=/dev/zero of=/tmp/mem bs=1M count=80`
